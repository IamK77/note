# 计算机网络体系结构

ISP: 网络提供商, 如电信、联通、移动、AT&T等等

ISP通过光纤接入各家各户的光猫提供网络

ASN: 自助系统编号, 每个ISP都有属于自己的ASN域

1969年阿帕网(ARPNET)投入运行标志互联网的诞生

# 计算机网络的层次结构

分为ISO/OSI参考模型和TCP/IP模型

## ISO/OSI参考模型按以下层次划分

- 应用层  
- 表示层  
- 会话层  
- 传输层  
- 网络层  
- 数据链路层  
- 物理层  

## TCP/IP模型按以下层次划分

- 应用层  
- 传输层  
- 网际层  
- 网络接口层  

> ISO/OSI参考模型仅是一种理想中的模型, 但并无实现, TCP/IP模型则是目前正在运用的模型 

考研王道采用综合两种模型的方法进行讨论, 按以下层次划分

- 应用层  
- 传输层  
- 网络层  
- 数据链路层  
- 物理层  

## 网络层次梳理

我们按ISO/OSI参考模型来对网络层次进行一个梳理

层次与层次之间, 下层为上层提供服务, 上层不关心下层如何实现, 只使用下层提供的接口

我们自上而下

- 应用层: 直接为用户提供服务, 例如浏览网页(HTTP), 发送电子邮件(SMTP)、传输文件(FTP)等等

- 表示层: 对数据进行编码和解码, 加密或解密, 压缩或解缩等等, 对数据进行加工, 以便更方便的发送/使用   
    例如: 发送电子邮件时, 根据Unicode将文字编码为二进制再传至下一层进行发送

- 会话层: 在本机和对方之间建立起一个会话(Session), 由会话层来主导该会话

- 传输层: 负责会话的传输部分, 为端到端提供可靠的传输服务

- 网络层: 在网络通信中选择最佳路径, 并对传输进行流量控制、差错控制等    
    例如: 从杭州向武汉/常州/香港/荷兰/福州发送数据, 网络层就会找出杭州与武汉/常州/香港/荷兰/福州之间的最佳路线, 如果传输过程中发生差错, 网络层就会控制主机重传

- 数据链路层: 在直接相连的节点中提供可靠传输    
    杭州到武汉/常州/香港/荷兰/福州的线路, 并非直接相连, 而是一个个节点相连, 数据链路层就负责每一小段每一小段的数据传输

- 物理层: 整个路线中的每一根物理线缆, 都由物理层负责

>端到端:    
在计算机中, 有虚拟的网络端口, 共有2^16个, 每个进程允许占用多个端口  
当我们说端到端通信, 往往指从本机端口发送数据到另一个端口, 另一个端口可以是本机端口, 也可以是其他计算机端口;而端口被进程使用, 因此本质就是进程与进程通信    
例如: mc默认使用25565端口进行联机, 主机打开联机后, 客机访问 主机ipv4:25565 就可以进行联机   

> 点到点通信: 往往指计算机与计算机之间的通信, 点指计算机硬件拥有的MAC地址/IP地址

> 面向连接: 要求双方在数据传输前, 先建立一个稳定的连接;连接可以确保数据按顺序到达, 并有错误检测和纠正

> 无连接: 无需先建立连接, 每个数据包独立传输

协议: 在同一层中使用, 在其他层不可用不可见;按约定的内容进行通信, 就是协议

服务: 由下层对上层提供, 将本层的功能抽象成接口提供给上层使用

服务数据单元(SDU): 本层接收到上一层的数据, 该数据就称为SDU  
SDU: Service Data Unit

协议控制信息(PCI): 控制协议操作的信息   
接收到上一层的SDU后, 本层会把本层协议所需的PCI添加到SDU中   
PCI: Protocol Control Information

协议数据单元(PDU): PCI添加到SDU后, 所形成的新数据就称为PDU, 也就是本层协议传输所需的数据格式;当传输到更低层时, 本层的PDU就是下层的SDU  
PDU: Protocol Data Unit

- WAN: 广域网, 提供长距离通信;
- MAN: 城域网, 覆盖范围跨越几个街区甚至城市;孩子们, 这并不好笑
- LAN: 局域网, 覆盖范围为几十到几千米;
- PAN: 不重要

路由器有LAN接口, 通过网线将计算机与路由器相连, 计算机就连接上该路由器所属的网络     
路由器上有一个WAN接口, 插入光猫接来的线缆, 该路由器所属的网络就接上了互联网

### 传输技术

广播式网络: 无线连接    
点对点网络: 两个计算机之间用物理线缆连接

## 时延计算

发送时延(数据传播速率): 结点发送第一个bit算起, 到最后一个bit发送完毕所需的时间, 单位为b/s   
发送时延＝分组长度/发送速率

分组长度: 分组交换中一个分组的长度, 单位B/b     
发送速率: 结点发送数据的速率, 单位Mb/s

传播时延: 一个bit从链路一端到另一端所需的时间   
传播时延＝信道长度/电磁波在信道的传播速率

信道长度: 即线缆长度, 单位与长度单位同  
传播速率: 单位m/s

处理时延: 在结点进行必要处理所花费的时间, 不重要    
排队时延: 不重要

总时延＝发送时延+传播时延+处理时延+排队时延  

时延宽带积＝传播时延*信道带宽   
信道利用率＝有数据通过时间/(有+无)数据通过时间     
带宽: 单位为b/s, 或者说bps, 即bit per second

往返时延: RTT, 顾名思义, 往返总时间     

信道利用率并非越高越好, 利用率过高可能造成阻塞

>1GB＝1024MB    
1MB＝1024KB     
1KB＝1024B   B即Bytes, 字节     
1B＝8b   b即bit, 比特   

## 交换

电路交换: 采用直通方式接发数据, 通信时延小, 流程为`连接建立->数据传送->连接释放`

报文交换: 直接发送

分组交换: 仅需计算第一个分组的(发送时延+传播时延)\*链路数量, 再加剩余分组抵达的时间 发送时延\*(分组总数-1) 

$$
\text{时间} = (\text{发送时延} + \text{传播时延}) \times \text{链路数量} + \text{发送时延} \times (\text{分组总数} - 1)
$$

看起来很复杂^^?